<!-- templates/sidebar.html -->
<aside class="sidebar">
  <div class="sb-head">
    <div class="sb-title">Marketplace Manager</div>

    <div class="sb-userbox">
      <div id="sb-usuario" class="sb-user">â€”</div>
      <div id="sb-rol" class="sb-rol muted">â€”</div>
    </div>
  </div>

  <nav class="sb-nav">
    <!-- ===================== COMUNES ===================== -->
    <a data-key="dashboard" href="../dashboard/dashboard.html">ğŸ  Dashboard</a>

    <!-- ===================== OPERADOR ===================== -->
    <a data-key="diario" class="only-operador" href="../diario/diario.html">ğŸ—“ï¸ Diario</a>
    <a data-key="recursos" class="only-operador" href="../publicaciones/publicaciones.html">ğŸ“ Recursos (Fotos)</a>
    <a data-key="calentamiento" class="only-operador" href="../calentamiento/calentamiento.html">ğŸ”¥ Calentamiento</a>
    <a data-key="mensajes" class="only-operador" href="../mensajes/mensajes.html">ğŸ’¬ Mensajes</a>
    <a data-key="reportar_error" class="only-operador" href="../reportar_error/reportar_error.html">ğŸ› ï¸ Reportar error</a>

    <!-- ===================== GERENTE ===================== -->
    <a data-key="gestionar_recursos" class="only-gerente" href="../publicaciones_gerente/publicaciones_gerente.html">ğŸ“¦ Gestionar Recursos</a>
    <a data-key="categorias" class="only-gerente" href="../categoria/categoria.html">ğŸ·ï¸ CategorÃ­as</a>
    <a data-key="cuentas_fb" class="only-gerente" href="../cuentas_fb/cuentas_fb.html">ğŸ‘¤ Cuentas Facebook</a>
    <a data-key="asignaciones" class="only-gerente" href="../asignaciones/asignaciones.html">ğŸ§© Asignaciones</a>
    <a data-key="actividad" class="only-gerente" href="../actividad/actividad.html">ğŸ“¡ Actividad</a>
    <a data-key="usuarios" class="only-gerente" href="../usuarios/usuarios.html">ğŸ‘¥ Usuarios</a>
    <a data-key="verificacion" class="only-gerente" href="../verificacion/verificacion.html">âœ… VerificaciÃ³n</a>
    <a data-key="metricas" class="only-gerente" href="../metricas/metricas.html">ğŸ“ˆ MÃ©tricas</a>
    <a data-key="calentamiento_gerente" class="only-gerente" href="../calentamiento_gerente/calentamiento_gerente.html">ğŸ”¥ Calentamiento (Gerente)</a>

    <!-- El gerente ve reportes, el operador NO -->
    <a data-key="reportes_errores" class="only-gerente" href="../reportes_errores/reportes_errores.html">ğŸ§¾ Reportes de errores</a>
  </nav>

  <div class="sb-foot">
    <button id="sb-salir" class="btn-danger" style="width:100%;">Salir</button>
  </div>

  <!-- âœ… Solo ocultamos/mostramos. No te cambiamos el tema. -->
  <style>
    .only-gerente, .only-operador { display: none; }
    .role-gerente .only-gerente { display: flex; }
    .role-operador .only-operador { display: flex; }

    /* Si tu app.css ya define estilos, esto casi no afecta.
       Es solo para que el sidebar no se rompa si faltan clases. */
    .sidebar { display:flex; flex-direction:column; height:100%; }
    .sb-head { padding:14px; }
    .sb-title { font-weight:900; color:white; }
    .sb-userbox { margin-top:10px; }
    .sb-user { color:white; font-weight:800; }
    .sb-rol { margin-top:2px; font-size:0.85rem; }

    .sb-nav { display:flex; flex-direction:column; gap:6px; padding:0 10px; }
    .sb-nav a { display:flex; align-items:center; gap:10px; padding:10px 12px; border-radius:12px; text-decoration:none; }

    .sb-foot { padding:14px; margin-top:auto; }
  </style>

  <script>
    (function () {
      let s = null;
      try { s = JSON.parse(localStorage.getItem("mp_session_v1") || "null"); } catch {}

      const usuario = s?.usuario || "â€”";
      const rol = s?.rol || "operador"; // default operador

      const u = document.getElementById("sb-usuario");
      const r = document.getElementById("sb-rol");
      if (u) u.textContent = usuario;
      if (r) r.textContent = "Rol: " + rol;

      const root = document.querySelector(".sidebar");
      if (root) root.classList.add(rol === "gerente" ? "role-gerente" : "role-operador");

      const btn = document.getElementById("sb-salir");
      if (btn) {
        btn.onclick = () => {
          localStorage.removeItem("mp_session_v1");
          location.href = "../login/login.html";
        };
      }
    })();
  </script>
</aside>
